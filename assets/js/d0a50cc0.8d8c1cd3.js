"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[6811],{3905:function(e,n,t){t.d(n,{Zo:function(){return s},kt:function(){return m}});var r=t(7294);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function a(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,r,o=function(e,n){if(null==e)return{};var t,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var c=r.createContext({}),p=function(e){var n=r.useContext(c),t=n;return e&&(t="function"==typeof e?e(n):a(a({},n),e)),t},s=function(e){var n=p(e.components);return r.createElement(c.Provider,{value:n},e.children)},u={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},h=r.forwardRef((function(e,n){var t=e.components,o=e.mdxType,i=e.originalType,c=e.parentName,s=l(e,["components","mdxType","originalType","parentName"]),h=p(t),m=o,f=h["".concat(c,".").concat(m)]||h[m]||u[m]||i;return t?r.createElement(f,a(a({ref:n},s),{},{components:t})):r.createElement(f,a({ref:n},s))}));function m(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var i=t.length,a=new Array(i);a[0]=h;var l={};for(var c in n)hasOwnProperty.call(n,c)&&(l[c]=n[c]);l.originalType=e,l.mdxType="string"==typeof e?e:o,a[1]=l;for(var p=2;p<i;p++)a[p]=t[p];return r.createElement.apply(null,a)}return r.createElement.apply(null,t)}h.displayName="MDXCreateElement"},8586:function(e,n,t){t.r(n),t.d(n,{assets:function(){return s},contentTitle:function(){return c},default:function(){return m},frontMatter:function(){return l},metadata:function(){return p},toc:function(){return u}});var r=t(7462),o=t(3366),i=(t(7294),t(3905)),a=["components"],l={description:"Tutorial on whisper with Go."},c="Connecting Whisper Client",p={unversionedId:"en/whisper-client/README",id:"en/whisper-client/README",title:"Connecting Whisper Client",description:"Tutorial on whisper with Go.",source:"@site/docs/en/whisper-client/README.md",sourceDirName:"en/whisper-client",slug:"/en/whisper-client/",permalink:"/ethereum-development-with-go-book/docs/en/whisper-client/",editUrl:"https://github.com/mhxw/ethereum-development-with-go-book/tree/dev/docs/en/whisper-client/README.md",tags:[],version:"current",frontMatter:{description:"Tutorial on whisper with Go."},sidebar:"en",previous:{title:"Swarm",permalink:"/ethereum-development-with-go-book/docs/en/swarm/"},next:{title:"Generating Whisper Key Pair",permalink:"/ethereum-development-with-go-book/docs/en/whisper-keys/"}},s={},u=[{value:"Full code",id:"full-code",level:3}],h={toc:u};function m(e){var n=e.components,t=(0,o.Z)(e,a);return(0,i.kt)("wrapper",(0,r.Z)({},h,t,{components:n,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"connecting-whisper-client"},"Connecting Whisper Client"),(0,i.kt)("p",null,"To use whisper, we must first connect to an Ethereum node running whisper. Unfortunately, public gateways such as infura don't support whisper because there is no incentive for processing the messages for free. Infura might support whisper in the near future but for now we must run our own ",(0,i.kt)("inlineCode",{parentName:"p"},"geth")," node. Once you ",(0,i.kt)("a",{parentName:"p",href:"https://geth.ethereum.org/downloads/"},"install geth"),", run it with the ",(0,i.kt)("inlineCode",{parentName:"p"},"--shh")," flag on to enable the whisper protocol, as well as the ",(0,i.kt)("inlineCode",{parentName:"p"},"--ws")," flag to enable websocket support in order to receive messages in real time, and also enable the ",(0,i.kt)("inlineCode",{parentName:"p"},"--rpc")," flag because we'll be communicating over RPC."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"geth --rpc --shh --ws\n")),(0,i.kt)("p",null,"Now in our Go application we'll import the go-ethereum whisper client package found at ",(0,i.kt)("inlineCode",{parentName:"p"},"whisper/shhclient")," and initialize the client to connect our local geth node over websockets using the default websocket port ",(0,i.kt)("inlineCode",{parentName:"p"},"8546"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-go"},'client, err := shhclient.Dial("ws://127.0.0.1:8546")\nif err != nil {\n  log.Fatal(err)\n}\n\n_ = client // we\'ll be using this in the next section\n')),(0,i.kt)("p",null,"Now that we're dialed in let's create a key pair for encrypting the message before we send it in the ",(0,i.kt)("a",{parentName:"p",href:"../whisper-keys"},"next section"),"."),(0,i.kt)("hr",null),(0,i.kt)("h3",{id:"full-code"},"Full code"),(0,i.kt)("p",null,"Commands"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"geth --rpc --shh --ws\n")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://github.com/mhxw/ethereum-development-with-go-book/blob/main/code/whisper_client.go"},"whisper_client.go")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-go"},'package main\n\nimport (\n    "log"\n\n    "github.com/ethereum/go-ethereum/whisper/shhclient"\n)\n\nfunc main() {\n    client, err := shhclient.Dial("ws://127.0.0.1:8546")\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    _ = client // we\'ll be using this in the next section\n    fmt.Println("we have a whisper connection")\n}\n')))}m.isMDXComponent=!0}}]);